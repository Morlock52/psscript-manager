import{am as e,r as t,j as a,a3 as s,p as r,an as n,ao as i,T as o,$ as l,a8 as c,ap as d,aq as x,R as h,G as m,a5 as p,q as g,U as u,a6 as y,t as j,ak as b,ar as w,P as f,s as v,M as S,as as A,at as C,a2 as P,C as R,aa as I,ab as $,au as z,av as k,aw as D,a4 as E,x as T,w as _,ax as O,ay as B,az as F,aA as N,aB as W,D as L,L as G}from"./react-vendor-chunk-814f15fe.js";import{d as H}from"../assets/index-c161c383.js";import{a as M}from"./data-fetching-chunk-acdfbf86.js";import"./editor-chunk-85777d73.js";const K="/api/agents",q=(e,t)=>{const a={message:`Failed to ${t}`,code:"UNKNOWN_ERROR",isRetryable:!1};return M.isAxiosError(e)&&("ECONNABORTED"!==e.code&&e.response?e.response&&(a.status=e.response.status,a.details=e.response.data,401===e.response.status||403===e.response.status?(a.code="AUTH_ERROR",a.message=`Authentication error while ${t}. Please log in again.`,a.isRetryable=!1):404===e.response.status&&(a.code="NOT_FOUND",a.message=`Resource not found while ${t}`,a.isRetryable=!1)):(a.message=`Network error while ${t}: ${e.message}`,a.code="NETWORK_ERROR",a.isRetryable=!0)),console.error(`Agent orchestration error (${t}):`,a),a},U=async e=>{try{return(await H.post(K,e)).data}catch(t){throw q(t,"create agent")}},V=async e=>{try{return(await H.get(`${K}/runs/${e}`)).data}catch(t){throw q(t,"get run")}},Y=({agentConfig:P={name:"PowerShell Assistant",description:"I can help you with PowerShell scripting and automation",capabilities:["script_analysis","code_generation","security_review"],model:"gpt-4o"},initialMessage:R="Hello! I'm your PowerShell scripting assistant. How can I help you today?",placeholder:I="Ask anything about PowerShell scripting...",showToolbar:$=!0})=>{const z=e(),k=t.useRef(null),[D,E]=t.useState(null),[T,_]=t.useState(null),[O,B]=t.useState([]),[F,N]=t.useState(""),[W,L]=t.useState(!1),[G,M]=t.useState(null),[Y,J]=t.useState({open:!1,message:"",severity:"info"});t.useEffect(()=>((async()=>{try{const e=await U(P);E(e);const t=await(async(e,t)=>{try{return(await H.post(`${K}/threads`,{agentId:e,message:t})).data}catch(G){throw q(G,"create thread")}})(e.id);_(t);const a={id:"welcome-msg",threadId:t.id,role:"assistant",content:R,metadata:{},createdAt:new Date};B([a])}catch(e){console.error("Failed to initialize agent:",e),M("Failed to initialize the assistant. Please try again later."),J({open:!0,message:"Failed to initialize the assistant",severity:"error"})}})(),()=>{}),[!0,P,R]),t.useEffect(()=>{k.current?.scrollIntoView({behavior:"smooth"})},[O]);const Q=async()=>{if(!F.trim()||!T||!D||W)return;const e=F;N(""),L(!0);try{const t={id:`temp-${Date.now()}`,threadId:T.id,role:"user",content:e,metadata:{},createdAt:new Date};B(e=>[...e,t]),await(async(e,t,a="user")=>{try{return(await H.post(`${K}/threads/${e}/messages`,{content:t,role:a})).data}catch(G){throw q(G,"add message")}})(T.id,e);const a=await(async e=>{try{return(await H.post(`${K}/threads/${e}/runs`)).data}catch(G){throw q(G,"create run")}})(T.id),s={id:`loading-${Date.now()}`,threadId:T.id,role:"assistant",content:"...",metadata:{isLoading:!0},createdAt:new Date};B(e=>[...e,s]),await(async(e,t=1e3,a=60)=>{let s=0;for(;s<a;){const a=await V(e);if(["completed","failed","cancelled"].includes(a.status))return a;await new Promise(e=>setTimeout(e,t)),s++}throw new Error(`Run ${e} did not complete within the timeout period`)})(a.id);const r=await(async e=>{try{return(await H.get(`${K}/threads/${e}`)).data}catch(G){throw q(G,"get thread")}})(T.id),n=await(async e=>{try{return(await H.get(`${K}/threads/${e}/messages`)).data}catch(G){throw q(G,"get thread messages")}})(T.id);_(r),B(n)}catch(t){console.error("Error sending message:",t),M("Failed to send message. Please try again."),J({open:!0,message:"Failed to send message",severity:"error"}),B(e=>e.filter(e=>!e.metadata?.isLoading))}finally{L(!1)}},X=()=>{J(e=>({...e,open:!1}))},Z=e=>{const t="user"===e.role,s=e.metadata?.isLoading;return a.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:t?"flex-end":"flex-start",mb:2},children:[a.jsxs(r,{sx:{display:"flex",flexDirection:t?"row-reverse":"row",alignItems:"flex-start",gap:1},children:[a.jsx(n,{sx:{bgcolor:t?z.palette.primary.main:z.palette.secondary.main,color:"#fff"},children:t?a.jsx(w,{}):a.jsx(i,{})}),a.jsx(f,{elevation:1,sx:{p:2,maxWidth:"80%",borderRadius:2,bgcolor:t?z.palette.primary.light:z.palette.background.paper,color:t?"#fff":"inherit"},children:s?a.jsxs(r,{sx:{width:"100%",minWidth:"200px"},children:[a.jsx(v,{}),a.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Thinking..."})]}):a.jsx(r,{children:a.jsx(S,{children:e.content||"",components:{code({node:e,inline:t,className:s,children:r,...n}){const i=/language-(\w+)/.exec(s||"");return!t&&i?a.jsx(A,{children:String(r).replace(/\n$/,""),style:C,language:i[1],PreTag:"div",...n}):a.jsx("code",{className:s,...n,children:r})}}})})})]}),a.jsx(o,{variant:"caption",color:"text.secondary",sx:{mt:.5,mx:2,alignSelf:t?"flex-end":"flex-start"},children:new Date(e.createdAt).toLocaleTimeString()})]})};return a.jsxs(s,{elevation:3,sx:{height:"100%",display:"flex",flexDirection:"column"},children:[a.jsxs(r,{sx:{p:2,borderBottom:1,borderColor:"divider",bgcolor:"background.paper",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[a.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[a.jsx(n,{sx:{bgcolor:z.palette.secondary.main},children:a.jsx(i,{})}),a.jsxs(r,{children:[a.jsx(o,{variant:"subtitle1",fontWeight:"bold",children:D?.name||"PowerShell Assistant"}),a.jsx(l,{size:"small",label:D?.model||"GPT-4o",sx:{fontSize:"0.7rem"}})]})]}),$&&a.jsxs(r,{children:[a.jsx(c,{size:"small",title:"Restart conversation",children:a.jsx(d,{fontSize:"small"})}),a.jsx(c,{size:"small",title:"About this assistant",children:a.jsx(x,{fontSize:"small"})})]})]}),a.jsxs(r,{sx:{flexGrow:1,p:2,overflow:"auto",bgcolor:"dark"===z.palette.mode?"grey.900":"grey.50"},children:[O.map(e=>a.jsx(h.Fragment,{children:Z(e)},e.id)),a.jsx("div",{ref:k})]}),a.jsxs(r,{sx:{p:2,borderTop:1,borderColor:"divider",bgcolor:"background.paper"},children:[a.jsxs(m,{container:!0,spacing:1,alignItems:"flex-end",children:[a.jsx(m,{item:!0,xs:!0,children:a.jsx(p,{fullWidth:!0,multiline:!0,maxRows:4,placeholder:I,value:F,onChange:e=>N(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Q())},disabled:W||!T,variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),a.jsx(m,{item:!0,children:a.jsx(g,{variant:"contained",color:"primary",endIcon:W?a.jsx(u,{size:20,color:"inherit"}):a.jsx(y,{}),onClick:Q,disabled:!F.trim()||W||!T,sx:{borderRadius:2,px:3,py:1},children:W?"Sending...":"Send"})})]}),G&&a.jsx(j,{severity:"error",sx:{mt:2},children:G})]}),a.jsx(b,{open:Y.open,autoHideDuration:6e3,onClose:X,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:a.jsx(j,{onClose:X,severity:Y.severity,sx:{width:"100%"},children:Y.message})})]})},J=e=>{const{children:t,value:s,index:n,...i}=e;return a.jsx("div",{role:"tabpanel",hidden:s!==n,id:`agent-tabpanel-${n}`,"aria-labelledby":`agent-tab-${n}`,...i,children:s===n&&a.jsx(r,{sx:{p:3},children:t})})},Q=P(s)(({theme:e})=>({height:"100%",display:"flex",flexDirection:"column",transition:"transform 0.3s, box-shadow 0.3s",cursor:"pointer","&:hover":{transform:"translateY(-5px)",boxShadow:e.shadows[10]}})),X=P(n)(({theme:e})=>({width:56,height:56,backgroundColor:e.palette.primary.main,marginBottom:e.spacing(2)})),Z=[{name:"PowerShell Expert",description:"Specializes in PowerShell scripting advice, best practices, and code generation",capabilities:["script_analysis","code_generation","best_practices"],model:"gpt-4o",metadata:{category:"programming",expertise:"powershell"}},{name:"Security Reviewer",description:"Analyzes PowerShell scripts for security vulnerabilities and potential risks",capabilities:["security_analysis","risk_assessment","remediation"],model:"gpt-4o",metadata:{category:"security",expertise:"script_security"}},{name:"Script Generator",description:"Creates PowerShell scripts based on your requirements and specifications",capabilities:["code_generation","requirements_analysis"],model:"gpt-4o",metadata:{category:"productivity",expertise:"automation"}}],ee=()=>{const[e,s]=t.useState(0),[c,d]=t.useState(null),[x,h]=t.useState(!1),[y,b]=t.useState(null);return a.jsxs(R,{maxWidth:"xl",sx:{py:4},children:[a.jsxs(o,{variant:"h4",component:"h1",gutterBottom:!0,sx:{fontWeight:"bold"},children:[a.jsx(i,{sx:{mr:1,verticalAlign:"middle"}}),"Agent Orchestration"]}),a.jsx(o,{variant:"body1",color:"text.secondary",paragraph:!0,children:"Leverage our agentic AI framework to create, customize, and interact with specialized PowerShell assistants. Each agent comes with its own capabilities and expertise to help with your scripting needs."}),a.jsx(r,{sx:{borderBottom:1,borderColor:"divider",mb:2},children:a.jsxs(I,{value:e,onChange:(e,t)=>{s(t)},"aria-label":"agent tabs",children:[a.jsx($,{icon:a.jsx(z,{}),label:"Create Agent",id:"agent-tab-0","aria-controls":"agent-tabpanel-0"}),a.jsx($,{icon:a.jsx(i,{}),label:"Chat",id:"agent-tab-1","aria-controls":"agent-tabpanel-1",disabled:!c}),a.jsx($,{icon:a.jsx(k,{}),label:"History",id:"agent-tab-2","aria-controls":"agent-tabpanel-2"}),a.jsx($,{icon:a.jsx(D,{}),label:"Settings",id:"agent-tab-3","aria-controls":"agent-tabpanel-3"})]})}),a.jsx(J,{value:e,index:0,children:a.jsxs(r,{sx:{mb:4},children:[a.jsx(o,{variant:"h6",gutterBottom:!0,children:"Select an Agent Template"}),a.jsx(o,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Choose a specialized agent to assist with your PowerShell scripting needs. Each agent has different capabilities and expertise."}),a.jsx(m,{container:!0,spacing:3,sx:{mt:2},children:Z.map((e,t)=>a.jsx(m,{item:!0,xs:12,sm:6,md:4,children:a.jsx(Q,{elevation:c?.name===e.name?6:2,onClick:()=>(e=>{d(e)})(e),sx:{borderColor:c?.name===e.name?"primary.main":"transparent",borderWidth:c?.name===e.name?2:0,borderStyle:"solid"},children:a.jsxs(E,{sx:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[a.jsxs(X,{children:["PowerShell Expert"===e.name&&a.jsx(T,{}),"Security Reviewer"===e.name&&a.jsx(_,{}),"Script Generator"===e.name&&a.jsx(O,{})]}),a.jsx(o,{variant:"h6",component:"h2",gutterBottom:!0,children:e.name}),a.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:2},children:e.description}),a.jsx(r,{sx:{display:"flex",flexWrap:"wrap",gap:.5,justifyContent:"center",mb:2},children:e.capabilities?.map((e,t)=>a.jsx(l,{label:e.replace("_"," "),size:"small",color:"primary",variant:"outlined"},t))}),a.jsx(l,{label:e.model,size:"small",color:"secondary",sx:{mt:"auto"}})]})})},t))}),a.jsx(r,{sx:{mt:4,display:"flex",justifyContent:"center"},children:a.jsx(g,{variant:"contained",color:"primary",size:"large",startIcon:x?a.jsx(u,{size:20,color:"inherit"}):a.jsx(i,{}),disabled:!c||x,onClick:()=>c&&(async e=>{h(!0),b(null);try{const t=await U(e);console.log("Created agent:",t),d(t),s(1)}catch(t){console.error("Failed to create agent:",t),b("Failed to create agent. Please try again.")}finally{h(!1)}})(c),sx:{px:4,py:1.5},children:x?"Creating...":"Create & Start Chat"})}),y&&a.jsx(j,{severity:"error",sx:{mt:2},children:y})]})}),a.jsx(J,{value:e,index:1,children:c?a.jsx(r,{sx:{height:"calc(100vh - 250px)",minHeight:"500px"},children:a.jsx(Y,{agentConfig:c,placeholder:`Ask ${c.name} anything about PowerShell...`})}):a.jsxs(r,{sx:{textAlign:"center",py:8},children:[a.jsx(o,{variant:"h6",color:"text.secondary",children:"Please select an agent template first"}),a.jsx(g,{variant:"outlined",startIcon:a.jsx(z,{}),onClick:()=>s(0),sx:{mt:2},children:"Create Agent"})]})}),a.jsxs(J,{value:e,index:2,children:[a.jsx(o,{variant:"h6",gutterBottom:!0,children:"Conversation History"}),a.jsx(o,{variant:"body2",color:"text.secondary",paragraph:!0,children:"View and continue your previous conversations with agents."}),a.jsx(f,{sx:{p:3},children:a.jsxs(B,{children:[a.jsxs(F,{secondaryAction:a.jsx(g,{size:"small",variant:"outlined",children:"Continue"}),children:[a.jsx(N,{children:a.jsx(n,{sx:{bgcolor:"primary.main"},children:a.jsx(i,{})})}),a.jsx(W,{primary:"PowerShell Expert",secondary:"Last message: 3 hours ago"})]}),a.jsx(L,{}),a.jsxs(F,{secondaryAction:a.jsx(g,{size:"small",variant:"outlined",children:"Continue"}),children:[a.jsx(N,{children:a.jsx(n,{sx:{bgcolor:"secondary.main"},children:a.jsx(_,{})})}),a.jsx(W,{primary:"Security Reviewer",secondary:"Last message: Yesterday at 2:15 PM"})]})]})})]}),a.jsxs(J,{value:e,index:3,children:[a.jsx(o,{variant:"h6",gutterBottom:!0,children:"Agent Settings"}),a.jsx(o,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Configure agent behavior, API settings, and other preferences."}),a.jsxs(f,{sx:{p:3},children:[a.jsxs(r,{sx:{mb:3},children:[a.jsx(o,{variant:"subtitle1",gutterBottom:!0,children:"API Configuration"}),a.jsx(j,{severity:"info",sx:{mb:2},children:"Agent settings use your OpenAI API key configured in the Settings page."}),a.jsx(g,{variant:"outlined",startIcon:a.jsx(D,{}),component:G,to:"/settings/api",children:"Manage API Keys"})]}),a.jsx(L,{sx:{my:3}}),a.jsxs(r,{children:[a.jsx(o,{variant:"subtitle1",gutterBottom:!0,children:"Default Agent Model"}),a.jsxs(p,{select:!0,label:"Default Model",defaultValue:"gpt-4o",fullWidth:!0,sx:{mb:2},"aria-label":"Select default AI model",children:[a.jsx("option",{value:"gpt-4o",children:"GPT-4o (Recommended)"}),a.jsx("option",{value:"gpt-3.5-turbo",children:"GPT-3.5 Turbo (Faster)"})]})]})]})]})]})};export{ee as default};
